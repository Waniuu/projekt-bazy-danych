<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Logowanie</title>
  <link rel="stylesheet" href="templatemo-noir-fashion.css">
</head>

<body>
<div class="login-container" style="max-width:420px;margin:80px auto;padding:30px;background:#1a1a1a;border-radius:15px;box-shadow:0 0 20px rgba(255,255,255,0.1);">
  <h2 style="text-align:center;color:white;margin-bottom:20px;">Logowanie</h2>

  <form id="loginForm">
    <div class="form-group">
      <label style="color:white" for="login">Login lub email</label>
      <input type="text" id="login" required style="width:100%;padding:10px;border-radius:8px;margin-top:5px;">
    </div>

    <div class="form-group" style="margin-top:15px;">
      <label style="color:white" for="password">Hasło</label>
      <input type="password" id="password" required style="width:100%;padding:10px;border-radius:8px;margin-top:5px;">
    </div>

    <button type="submit" class="form-submit" style="width:100%;margin-top:25px;">Zaloguj się</button>
  </form>

  <p id="loginMessage" style="color:red;margin-top:15px;text-align:center;"></p>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const API_LOGIN = "https://projekt-bazy-danych-backend.onrender.com/api/login";

    const form = document.getElementById("loginForm");
    const loginInput = document.getElementById("login");
    const passwordInput = document.getElementById("password");

    form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const login = loginInput.value.trim();
        const haslo = passwordInput.value.trim();

        try {
            const res = await fetch(API_LOGIN, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ login, haslo })
            });

            const data = await res.json();

            if (!data.success) {
                document.getElementById("loginMessage").innerText = data.message || "Niepoprawne dane logowania.";
                return;
            }

        localStorage.setItem("user", JSON.stringify(data.user));
        localStorage.setItem("rola", data.rola);

        alert("Zalogowano pomyślnie!");
        window.location.href = `dashboard_${data.rola}.html`
        } catch (err) {
            alert("Błąd połączenia z serwerem.");
        }
    });
});
</script>

</body>
</html>

